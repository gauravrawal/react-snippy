function ne(t){let e=o=>{if(o===null)r.write8(0);else if(typeof o=="boolean")r.write8(1),r.write8(+o);else if(typeof o=="number")r.write8(2),r.write32(o|0);else if(typeof o=="string")r.write8(3),r.write(V(o));else if(o instanceof Uint8Array)r.write8(4),r.write(o);else if(o instanceof Array){r.write8(5),r.write32(o.length);for(let p of o)e(p)}else{let p=Object.keys(o);r.write8(6),r.write32(p.length);for(let l of p)r.write(V(l)),e(o[l])}},r=new te;return r.write32(0),r.write32(t.id<<1|+!t.isRequest),e(t.value),re(r.buf,r.len-4,0),r.buf.subarray(0,r.len)}function ue(t){let e=()=>{switch(r.read8()){case 0:return null;case 1:return!!r.read8();case 2:return r.read32();case 3:return J(r.read());case 4:return r.read();case 5:{let i=r.read32(),f=[];for(let c=0;c<i;c++)f.push(e());return f}case 6:{let i=r.read32(),f={};for(let c=0;c<i;c++)f[J(r.read())]=e();return f}default:throw new Error("Invalid packet")}},r=new te(t),o=r.read32(),p=(o&1)===0;o>>>=1;let l=e();if(r.ptr!==t.length)throw new Error("Invalid packet");return{id:o,isRequest:p,value:l}}var te=class{constructor(e=new Uint8Array(1024)){this.buf=e;this.len=0;this.ptr=0}_write(e){if(this.len+e>this.buf.length){let r=new Uint8Array((this.len+e)*2);r.set(this.buf),this.buf=r}return this.len+=e,this.len-e}write8(e){let r=this._write(1);this.buf[r]=e}write32(e){let r=this._write(4);re(this.buf,e,r)}write(e){let r=this._write(4+e.length);re(this.buf,e.length,r),this.buf.set(e,r+4)}_read(e){if(this.ptr+e>this.buf.length)throw new Error("Invalid packet");return this.ptr+=e,this.ptr-e}read8(){return this.buf[this._read(1)]}read32(){return le(this.buf,this._read(4))}read(){let e=this.read32(),r=new Uint8Array(e),o=this._read(r.length);return r.set(this.buf.subarray(o,o+e)),r}},V,J;if(typeof TextEncoder!="undefined"&&typeof TextDecoder!="undefined"){let t=new TextEncoder,e=new TextDecoder;V=r=>t.encode(r),J=r=>e.decode(r)}else if(typeof Buffer!="undefined")V=t=>Buffer.from(t),J=t=>Buffer.from(t).toString();else throw new Error("No UTF-8 codec found");function le(t,e){return t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24}function re(t,e,r){t[r++]=e,t[r++]=e>>8,t[r++]=e>>16,t[r++]=e>>24}function ce(t){if(t+="",t.indexOf(",")>=0)throw new Error(`Invalid target: ${t}`);return t}var C=t=>typeof t=="boolean"?null:"a boolean",y=t=>typeof t=="string"?null:"a string",fe=t=>t instanceof RegExp?null:"a RegExp object",Z=t=>typeof t=="number"&&t===(t|0)?null:"an integer",de=t=>typeof t=="function"?null:"a function",q=t=>Array.isArray(t)?null:"an array",Q=t=>typeof t=="object"&&t!==null&&!Array.isArray(t)?null:"an object",Se=t=>typeof t=="object"&&!Array.isArray(t)?null:"an object or null",ie=t=>typeof t=="string"||typeof t=="boolean"?null:"a string or a boolean",Oe=t=>typeof t=="string"||typeof t=="object"&&t!==null&&!Array.isArray(t)?null:"a string or an object",xe=t=>typeof t=="string"||Array.isArray(t)?null:"a string or an array",Ee=t=>typeof t=="string"||t instanceof Uint8Array?null:"a string or a Uint8Array";function n(t,e,r,o){let p=t[r];if(e[r+""]=!0,p===void 0)return;let l=o(p);if(l!==null)throw new Error(`"${r}" must be ${l}`);return p}function N(t,e,r){for(let o in t)if(!(o in e))throw new Error(`Invalid option ${r}: "${o}"`)}function pe(t){let e=Object.create(null),r=n(t,e,"wasmURL",y),o=n(t,e,"worker",C);return N(t,e,"in startService() call"),{wasmURL:r,worker:o}}function X(t,e,r,o,p){let l=n(e,r,"color",C),i=n(e,r,"logLevel",y),f=n(e,r,"errorLimit",Z);l?t.push(`--color=${l}`):o&&t.push("--color=true"),t.push(`--log-level=${i||p}`),t.push(`--error-limit=${f||0}`)}function me(t,e,r){let o=n(e,r,"target",xe),p=n(e,r,"format",y),l=n(e,r,"globalName",y),i=n(e,r,"minify",C),f=n(e,r,"minifySyntax",C),c=n(e,r,"minifyWhitespace",C),h=n(e,r,"minifyIdentifiers",C),v=n(e,r,"charset",y),$=n(e,r,"treeShaking",ie),S=n(e,r,"jsxFactory",y),k=n(e,r,"jsxFragment",y),D=n(e,r,"define",Q),P=n(e,r,"pure",q),K=n(e,r,"avoidTDZ",C),_=n(e,r,"keepNames",C),M=n(e,r,"banner",y),g=n(e,r,"footer",y);if(o&&(Array.isArray(o)?t.push(`--target=${Array.from(o).map(ce).join(",")}`):t.push(`--target=${ce(o)}`)),p&&t.push(`--format=${p}`),l&&t.push(`--global-name=${l}`),i&&t.push("--minify"),f&&t.push("--minify-syntax"),c&&t.push("--minify-whitespace"),h&&t.push("--minify-identifiers"),v&&t.push(`--charset=${v}`),$!==void 0&&$!==!0&&t.push(`--tree-shaking=${$}`),S&&t.push(`--jsx-factory=${S}`),k&&t.push(`--jsx-fragment=${k}`),D)for(let a in D){if(a.indexOf("=")>=0)throw new Error(`Invalid define: ${a}`);t.push(`--define:${a}=${D[a]}`)}if(P)for(let a of P)t.push(`--pure:${a}`);K&&t.push("--avoid-tdz"),_&&t.push("--keep-names"),M&&t.push(`--banner=${M}`),g&&t.push(`--footer=${g}`)}function $e(t,e,r,o,p){var d;let l=[],i=Object.create(null),f=null,c=null;X(l,e,i,r,o),me(l,e,i);let h=n(e,i,"sourcemap",ie),v=n(e,i,"sourcesContent",C),$=n(e,i,"bundle",C),S=n(e,i,"splitting",C),k=n(e,i,"metafile",y),D=n(e,i,"outfile",y),P=n(e,i,"outdir",y),K=n(e,i,"outbase",y),_=n(e,i,"platform",y),M=n(e,i,"tsconfig",y),g=n(e,i,"resolveExtensions",q),a=n(e,i,"mainFields",q),u=n(e,i,"external",q),B=n(e,i,"loader",Q),I=n(e,i,"outExtension",Q),U=n(e,i,"publicPath",y),T=n(e,i,"inject",q),b=n(e,i,"entryPoints",q),m=n(e,i,"stdin",Q),R=(d=n(e,i,"write",C))!=null?d:p,O=n(e,i,"incremental",C)===!0,F=n(e,i,"plugins",q);if(N(e,i,`in ${t}() call`),h&&l.push(`--sourcemap${h===!0?"":`=${h}`}`),v!==void 0&&l.push(`--sources-content=${v}`),$&&l.push("--bundle"),S&&l.push("--splitting"),k&&l.push(`--metafile=${k}`),D&&l.push(`--outfile=${D}`),P&&l.push(`--outdir=${P}`),K&&l.push(`--outbase=${K}`),_&&l.push(`--platform=${_}`),M&&l.push(`--tsconfig=${M}`),g){let s=[];for(let w of g){if(w+="",w.indexOf(",")>=0)throw new Error(`Invalid resolve extension: ${w}`);s.push(w)}l.push(`--resolve-extensions=${s.join(",")}`)}if(U&&l.push(`--public-path=${U}`),a){let s=[];for(let w of a){if(w+="",w.indexOf(",")>=0)throw new Error(`Invalid main field: ${w}`);s.push(w)}l.push(`--main-fields=${s.join(",")}`)}if(u)for(let s of u)l.push(`--external:${s}`);if(T)for(let s of T)l.push(`--inject:${s}`);if(B)for(let s in B){if(s.indexOf("=")>=0)throw new Error(`Invalid loader extension: ${s}`);l.push(`--loader:${s}=${B[s]}`)}if(I)for(let s in I){if(s.indexOf("=")>=0)throw new Error(`Invalid out extension: ${s}`);l.push(`--out-extension:${s}=${I[s]}`)}if(b)for(let s of b){if(s+="",s.startsWith("-"))throw new Error(`Invalid entry point: ${s}`);l.push(s)}if(m){let s=Object.create(null),w=n(m,s,"contents",y),E=n(m,s,"resolveDir",y),A=n(m,s,"sourcefile",y),x=n(m,s,"loader",y);N(m,s,'in "stdin" object'),A&&l.push(`--sourcefile=${A}`),x&&l.push(`--loader=${x}`),E&&(c=E+""),f=w?w+"":""}return{flags:l,write:R,plugins:F,stdinContents:f,stdinResolveDir:c,incremental:O}}function ke(t,e,r,o){let p=[],l=Object.create(null);X(p,e,l,r,o),me(p,e,l);let i=n(e,l,"sourcemap",ie),f=n(e,l,"tsconfigRaw",Oe),c=n(e,l,"sourcefile",y),h=n(e,l,"loader",y);return N(e,l,`in ${t}() call`),i&&p.push(`--sourcemap=${i===!0?"external":i}`),f&&p.push(`--tsconfig-raw=${typeof f=="string"?f:JSON.stringify(f)}`),c&&p.push(`--sourcefile=${c}`),h&&p.push(`--loader=${h}`),p}function ye(t){let e=new Map,r=new Map,o=new Map,p=0,l=!1,i=0,f=0,c=new Uint8Array(16*1024),h=0,v=g=>{let a=h+g.length;if(a>c.length){let B=new Uint8Array(a*2);B.set(c),c=B}c.set(g,h),h+=g.length;let u=0;for(;u+4<=h;){let B=le(c,u);if(u+4+B>h)break;u+=4,K(c.slice(u,u+B)),u+=B}u>0&&(c.set(c.slice(u)),h-=u)},$=()=>{l=!0;for(let g of e.values())g("The service was stopped",null);e.clear();for(let g of o.values())g.onWait("The service was stopped");o.clear()},S=(g,a)=>{if(l)return a("The service is no longer running",null);let u=i++;e.set(u,a),t.writeToStdin(ne({id:u,isRequest:!0,value:g}))},k=(g,a)=>{if(l)throw new Error("The service is no longer running");t.writeToStdin(ne({id:g,isRequest:!1,value:a}))},D=async(g,a)=>{try{switch(a.command){case"resolve":{let u=r.get(a.key);k(g,await u(a));break}case"load":{let u=r.get(a.key);k(g,await u(a));break}case"serve-request":{let u=o.get(a.serveID);k(g,{}),u&&u.onRequest&&u.onRequest(a.args);break}case"serve-wait":{let u=o.get(a.serveID);k(g,{}),u&&u.onWait(a.error);break}default:throw new Error("Invalid command: "+a.command)}}catch(u){k(g,{errors:[await H(u,t)]})}},P=!0,K=g=>{if(P){P=!1;let u=String.fromCharCode(...g);if(u!=="0.8.27")throw new Error(`Cannot start service: Host version "0.8.27" does not match binary version ${JSON.stringify(u)}`);return}let a=ue(g);if(a.isRequest)D(a.id,a.value);else{let u=e.get(a.id);e.delete(a.id),a.value.error?u(a.value.error,{}):u(null,a.value)}},_=(g,a,u)=>{if(t.isSync)throw new Error("Cannot use plugins in synchronous API calls");let B={},I={},U=0,T=0;a.plugins=[];for(let b of g){let m={};if(typeof b!="object")throw new Error(`Plugin at index ${T} must be an object`);let R=n(b,m,"name",y),O=n(b,m,"setup",de);if(typeof R!="string"||R==="")throw new Error(`Plugin at index ${T} is missing a name`);if(typeof O!="function")throw new Error(`[${R}] Plugin is missing a setup function`);N(b,m,`on plugin ${JSON.stringify(R)}`);let F={name:R,onResolve:[],onLoad:[]};T++,O({onResolve(d,s){let w={},E=n(d,w,"filter",fe),A=n(d,w,"namespace",y);if(N(d,w,`in onResolve() call for plugin ${JSON.stringify(R)}`),E==null)throw new Error(`[${F.name}] onResolve() call is missing a filter`);let x=U++;B[x]={name:R,callback:s},F.onResolve.push({id:x,filter:E.source,namespace:A||""})},onLoad(d,s){let w={},E=n(d,w,"filter",fe),A=n(d,w,"namespace",y);if(N(d,w,`in onLoad() call for plugin ${JSON.stringify(R)}`),E==null)throw new Error(`[${F.name}] onLoad() call is missing a filter`);let x=U++;I[x]={name:R,callback:s},F.onLoad.push({id:x,filter:E.source,namespace:A||""})}}),a.plugins.push(F)}return r.set(u,async b=>{switch(b.command){case"resolve":{let m={};for(let R of b.ids)try{let{name:O,callback:F}=B[R],d=await F({path:b.path,importer:b.importer,namespace:b.namespace,resolveDir:b.resolveDir});if(d!=null){if(typeof d!="object")throw new Error(`Expected onResolve() callback in plugin ${JSON.stringify(O)} to return an object`);let s={},w=n(d,s,"pluginName",y),E=n(d,s,"path",y),A=n(d,s,"namespace",y),x=n(d,s,"external",C),j=n(d,s,"errors",q),L=n(d,s,"warnings",q);N(d,s,`from onResolve() callback in plugin ${JSON.stringify(O)}`),m.id=R,w!=null&&(m.pluginName=w),E!=null&&(m.path=E),A!=null&&(m.namespace=A),x!=null&&(m.external=x),j!=null&&(m.errors=Y(j,"errors")),L!=null&&(m.warnings=Y(L,"warnings"));break}}catch(O){return{id:R,errors:[await H(O,t)]}}return m}case"load":{let m={};for(let R of b.ids)try{let{name:O,callback:F}=I[R],d=await F({path:b.path,namespace:b.namespace});if(d!=null){if(typeof d!="object")throw new Error(`Expected onLoad() callback in plugin ${JSON.stringify(O)} to return an object`);let s={},w=n(d,s,"pluginName",y),E=n(d,s,"contents",Ee),A=n(d,s,"resolveDir",y),x=n(d,s,"loader",y),j=n(d,s,"errors",q),L=n(d,s,"warnings",q);N(d,s,`from onLoad() callback in plugin ${JSON.stringify(O)}`),m.id=R,w!=null&&(m.pluginName=w),E instanceof Uint8Array?m.contents=E:E!=null&&(m.contents=V(E)),A!=null&&(m.resolveDir=A),x!=null&&(m.loader=x),j!=null&&(m.errors=Y(j,"errors")),L!=null&&(m.warnings=Y(L,"warnings"));break}}catch(O){return{id:R,errors:[await H(O,t)]}}return m}default:throw new Error("Invalid command: "+b.command)}}),()=>r.delete(u)},M=(g,a)=>{let u={},B=n(g,u,"port",Z),I=n(g,u,"host",y),U=n(g,u,"onRequest",de),T=p++,b,m=new Promise((R,O)=>{b=F=>{o.delete(T),F!==null?O(new Error(F)):R()}});return a.serve={serveID:T},N(g,u,"in serve() call"),B!==void 0&&(a.serve.port=B),I!==void 0&&(a.serve.host=I),o.set(T,{onRequest:U,onWait:b}),{wait:m,stop(){S({command:"serve-stop",serveID:T},()=>{})}}};return{readFromStdout:v,afterClose:$,service:{buildOrServe(g,a,u,B,I){let U="info";try{let T=f++,b=!t.isBrowser,{flags:m,write:R,plugins:O,stdinContents:F,stdinResolveDir:d,incremental:s}=$e(g,u,B,U,b),w={command:"build",key:T,flags:m,write:R,stdinContents:F,stdinResolveDir:d,incremental:s},E=a&&M(a,w),A=O&&O.length>0&&_(O,w,T),x,j=(L,W)=>{let z=L.errors,G=L.warnings;if(z.length>0)return W(ge("Build failed",z,G),null);let ee={warnings:G};if(L.outputFiles&&(ee.outputFiles=L.outputFiles.map(Be)),L.rebuildID!==void 0){if(!x){let oe=!1;x=()=>new Promise((we,be)=>{if(oe||l)throw new Error("Cannot rebuild");S({command:"rebuild",rebuildID:L.rebuildID},(se,ve)=>{if(se)return W(new Error(se),null);j(ve,(ae,Re)=>{ae?be(ae):we(Re)})})}),x.dispose=()=>{oe=!0,A&&A(),S({command:"rebuild-dispose",rebuildID:L.rebuildID},()=>{})}}ee.rebuild=x}return W(null,ee)};if(R&&t.isBrowser)throw new Error('Cannot enable "write" in the browser');if(s&&t.isSync)throw new Error('Cannot use "incremental" with a synchronous build');S(w,(L,W)=>{if(L)return I(new Error(L),null);if(E){let z=W,G={port:z.port,host:z.host,wait:E.wait,stop:E.stop};return I(null,G)}return A&&!s&&A(),j(W,I)})}catch(T){let b=[];try{X(b,u,{},B,U)}catch(m){}S({command:"error",flags:b,error:H(T,t)},()=>{I(T,null)})}},transform(g,a,u,B,I,U){let T="silent",b=m=>{try{let R=ke(g,u,B,T),O={command:"transform",flags:R,inputFS:m!==null,input:m!==null?m:a};S(O,(F,d)=>{if(F)return U(new Error(F),null);let s=d.errors,w=d.warnings,E=1,A=()=>--E===0&&U(null,{warnings:w,code:d.code,map:d.map});if(s.length>0)return U(ge("Transform failed",s,w),null);d.codeFS&&(E++,I.readFile(d.code,(x,j)=>{x!==null?U(x,null):(d.code=j,A())})),d.mapFS&&(E++,I.readFile(d.map,(x,j)=>{x!==null?U(x,null):(d.map=j,A())})),A()})}catch(R){let O=[];try{X(O,u,{},B,T)}catch(F){}S({command:"error",flags:O,error:H(R,t)},()=>{U(R,null)})}};if(a.length>1024*1024){let m=b;b=()=>I.writeFile(a,m)}b(null)}}}}function H(t,e){let r="Internal error",o=null;try{r=(t&&t.message||t)+""}catch(p){}try{let p=t.stack+"",l=p.split(`
`,3),i="    at ";if(e.readFileSync&&!l[0].startsWith(i)&&l[1].startsWith(i)){let f=l[1].slice(i.length);for(;;){let c=/^\S+ \((.*)\)$/.exec(f);if(c){f=c[1];continue}if(c=/^eval at \S+ \((.*)\)(?:, \S+:\d+:\d+)?$/.exec(f),c){f=c[1];continue}if(c=/^(\S+):(\d+):(\d+)$/.exec(f),c){let h=e.readFileSync(c[1],"utf8"),v=h.split(/\r\n|\r|\n|\u2028|\u2029/)[+c[2]-1]||"";o={file:c[1],namespace:"file",line:+c[2],column:+c[3]-1,length:0,lineText:v+`
`+l.slice(1).join(`
`)}}break}}}catch(p){}return{text:r,location:o}}function ge(t,e,r){let o=5,p=e.length<1?"":` with ${e.length} error${e.length<2?"":"s"}:`+e.slice(0,o+1).map((i,f)=>{if(f===o)return`
...`;if(!i.location)return`
error: ${i.text}`;let{file:c,line:h,column:v}=i.location;return`
${c}:${h}:${v}: error: ${i.text}`}).join(""),l=new Error(`${t}${p}`);return l.errors=e,l.warnings=r,l}function Y(t,e){let r=[],o=0;for(let p of t){let l={},i=n(p,l,"text",y),f=n(p,l,"location",Se);N(p,l,`in element ${o} of "${e}"`);let c=null;if(f!=null){let h={},v=n(f,h,"file",y),$=n(f,h,"namespace",y),S=n(f,h,"line",Z),k=n(f,h,"column",Z),D=n(f,h,"length",Z),P=n(f,h,"lineText",y);N(f,h,`in element ${o} of "${e}"`),c={file:v||"",namespace:$||"",line:S||0,column:k||0,length:D||0,lineText:P||""}}r.push({text:i||"",location:c}),o++}return r}function Be({path:t,contents:e}){let r=null;return{path:t,contents:e,get text(){return r===null&&(r=J(e)),r}}}function he(t,e){let r=new Map;return async o=>{let p=t(),l=JSON.stringify(o||{}),i=`${l} ${p}`,f=r.get(i),c=!1,h=()=>{if(c)throw new Error("The service was stopped")},v=()=>!c&&(c=!0,--f.refCount===0)?(r.delete(i),!0):!1;f===void 0&&(f={promise:e(JSON.parse(l)),refCount:0},r.set(i,f)),++f.refCount;try{let $=await f.promise;return{build:S=>(h(),$.build(S)),serve(S,k){return h(),$.serve(S,k)},transform(S,k){return h(),$.transform(S,k)},stop(){v()&&$.stop()}}}catch($){throw v(),$}}}var Ae="0.8.27",Te=()=>{throw new Error('The "build" API only works in node')},Fe=()=>{throw new Error('The "serve" API only works in node')},Ie=()=>{throw new Error('The "transform" API only works in node')},De=()=>{throw new Error('The "buildSync" API only works in node')},Ue=()=>{throw new Error('The "transformSync" API only works in node')},Pe=he(()=>"",async t=>{if(!t)throw new Error('Must provide an options object to "startService"');t=pe(t);let e=t.wasmURL,r=t.worker!==!1;if(!e)throw new Error('Must provide the "wasmURL" option');e+="";let o=await fetch(e);if(!o.ok)throw new Error(`Failed to download ${JSON.stringify(e)}`);let p=await o.arrayBuffer(),l='{let global={};for(let o=self;o;o=Object.getPrototypeOf(o))for(let k of Object.getOwnPropertyNames(o))global[k]=self[k];\n// Copyright 2018 The Go Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n(()=>{if(!(typeof global!="undefined"))if(typeof window!="undefined")window.global=window;else if(typeof self!="undefined")self.global=self;else throw new Error("cannot export Go (neither global, window nor self is defined)");if(!global.require&&typeof require!="undefined"&&(global.require=require),!global.fs&&global.require){const r=require("fs");Object.keys(r)!==0&&(global.fs=r)}const l=()=>{const r=new Error("not implemented");return r.code="ENOSYS",r};if(!global.fs){let r="";global.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(n,s){r+=g.decode(s);const i=r.lastIndexOf(`\n`);return i!=-1&&(console.log(r.substr(0,i)),r=r.substr(i+1)),s.length},write(n,s,i,c,f,u){if(i!==0||c!==s.length||f!==null){u(l());return}const h=this.writeSync(n,s);u(null,h)},chmod(n,s,i){i(l())},chown(n,s,i,c){c(l())},close(n,s){s(l())},fchmod(n,s,i){i(l())},fchown(n,s,i,c){c(l())},fstat(n,s){s(l())},fsync(n,s){s(null)},ftruncate(n,s,i){i(l())},lchown(n,s,i,c){c(l())},link(n,s,i){i(l())},lstat(n,s){s(l())},mkdir(n,s,i){i(l())},open(n,s,i,c){c(l())},read(n,s,i,c,f,u){u(l())},readdir(n,s){s(l())},readlink(n,s){s(l())},rename(n,s,i){i(l())},rmdir(n,s){s(l())},stat(n,s){s(l())},symlink(n,s,i){i(l())},truncate(n,s,i){i(l())},unlink(n,s){s(l())},utimes(n,s,i,c){c(l())}}}if(global.process||(global.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw l()},pid:-1,ppid:-1,umask(){throw l()},cwd(){throw l()},chdir(){throw l()}}),!global.crypto){const r=require("crypto");global.crypto={getRandomValues(n){r.randomFillSync(n)}}}global.performance||(global.performance={now(){const[r,n]=process.hrtime();return r*1e3+n/1e6}}),global.TextEncoder||(global.TextEncoder=require("util").TextEncoder),global.TextDecoder||(global.TextDecoder=require("util").TextDecoder);const d=new TextEncoder("utf-8"),g=new TextDecoder("utf-8");if(global.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=e=>{e!==0&&console.warn("exit code:",e)},this._exitPromise=new Promise(e=>{this._resolveExitPromise=e}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const r=(e,t)=>{this.mem.setUint32(e+0,t,!0),this.mem.setUint32(e+4,Math.floor(t/4294967296),!0)},n=e=>{const t=this.mem.getUint32(e+0,!0),o=this.mem.getInt32(e+4,!0);return t+o*4294967296},s=e=>{const t=this.mem.getFloat64(e,!0);if(t===0)return;if(!isNaN(t))return t;const o=this.mem.getUint32(e,!0);return this._values[o]},i=(e,t)=>{const o=2146959360;if(typeof t=="number"&&t!==0){if(isNaN(t)){this.mem.setUint32(e+4,o,!0),this.mem.setUint32(e,0,!0);return}this.mem.setFloat64(e,t,!0);return}if(t===void 0){this.mem.setFloat64(e,0,!0);return}let a=this._ids.get(t);a===void 0&&(a=this._idPool.pop(),a===void 0&&(a=this._values.length),this._values[a]=t,this._goRefCounts[a]=0,this._ids.set(t,a)),this._goRefCounts[a]++;let m=0;switch(typeof t){case"object":t!==null&&(m=1);break;case"string":m=2;break;case"symbol":m=3;break;case"function":m=4;break}this.mem.setUint32(e+4,o|m,!0),this.mem.setUint32(e,a,!0)},c=e=>{const t=n(e+0),o=n(e+8);return new Uint8Array(this._inst.exports.mem.buffer,t,o)},f=e=>{const t=n(e+0),o=n(e+8),a=new Array(o);for(let m=0;m<o;m++)a[m]=s(t+m*8);return a},u=e=>{const t=n(e+0),o=n(e+8);return g.decode(new DataView(this._inst.exports.mem.buffer,t,o))},h=Date.now()-performance.now();this.importObject={go:{"runtime.wasmExit":e=>{const t=this.mem.getInt32(e+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(t)},"runtime.wasmWrite":e=>{const t=n(e+8),o=n(e+16),a=this.mem.getInt32(e+24,!0);fs.writeSync(t,new Uint8Array(this._inst.exports.mem.buffer,o,a))},"runtime.resetMemoryDataView":e=>{this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":e=>{r(e+8,(h+performance.now())*1e6)},"runtime.walltime1":e=>{const t=new Date().getTime();r(e+8,t/1e3),this.mem.setInt32(e+16,t%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":e=>{const t=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(t,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(t);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},n(e+8)+1)),this.mem.setInt32(e+16,t,!0)},"runtime.clearTimeoutEvent":e=>{const t=this.mem.getInt32(e+8,!0);clearTimeout(this._scheduledTimeouts.get(t)),this._scheduledTimeouts.delete(t)},"runtime.getRandomData":e=>{crypto.getRandomValues(c(e+8))},"syscall/js.finalizeRef":e=>{const t=this.mem.getUint32(e+8,!0);if(this._goRefCounts[t]--,this._goRefCounts[t]===0){const o=this._values[t];this._values[t]=null,this._ids.delete(o),this._idPool.push(t)}},"syscall/js.stringVal":e=>{i(e+24,u(e+8))},"syscall/js.valueGet":e=>{const t=Reflect.get(s(e+8),u(e+16));e=this._inst.exports.getsp(),i(e+32,t)},"syscall/js.valueSet":e=>{Reflect.set(s(e+8),u(e+16),s(e+32))},"syscall/js.valueDelete":e=>{Reflect.deleteProperty(s(e+8),u(e+16))},"syscall/js.valueIndex":e=>{i(e+24,Reflect.get(s(e+8),n(e+16)))},"syscall/js.valueSetIndex":e=>{Reflect.set(s(e+8),n(e+16),s(e+24))},"syscall/js.valueCall":e=>{try{const t=s(e+8),o=Reflect.get(t,u(e+16)),a=f(e+32),m=Reflect.apply(o,t,a);e=this._inst.exports.getsp(),i(e+56,m),this.mem.setUint8(e+64,1)}catch(t){i(e+56,t),this.mem.setUint8(e+64,0)}},"syscall/js.valueInvoke":e=>{try{const t=s(e+8),o=f(e+16),a=Reflect.apply(t,void 0,o);e=this._inst.exports.getsp(),i(e+40,a),this.mem.setUint8(e+48,1)}catch(t){i(e+40,t),this.mem.setUint8(e+48,0)}},"syscall/js.valueNew":e=>{try{const t=s(e+8),o=f(e+16),a=Reflect.construct(t,o);e=this._inst.exports.getsp(),i(e+40,a),this.mem.setUint8(e+48,1)}catch(t){i(e+40,t),this.mem.setUint8(e+48,0)}},"syscall/js.valueLength":e=>{r(e+16,parseInt(s(e+8).length))},"syscall/js.valuePrepareString":e=>{const t=d.encode(String(s(e+8)));i(e+16,t),r(e+24,t.length)},"syscall/js.valueLoadString":e=>{const t=s(e+8);c(e+16).set(t)},"syscall/js.valueInstanceOf":e=>{this.mem.setUint8(e+24,s(e+8)instanceof s(e+16)?1:0)},"syscall/js.copyBytesToGo":e=>{const t=c(e+8),o=s(e+32);if(!(o instanceof Uint8Array||o instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const a=o.subarray(0,t.length);t.set(a),r(e+40,a.length),this.mem.setUint8(e+48,1)},"syscall/js.copyBytesToJS":e=>{const t=s(e+8),o=c(e+16);if(!(t instanceof Uint8Array||t instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const a=o.subarray(0,t.length);t.set(a),r(e+40,a.length),this.mem.setUint8(e+48,1)},debug:e=>{console.log(e)}}}}async run(r){this._inst=r,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,global,this],this._goRefCounts=new Array(this._values.length).fill(Infinity),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[global,5],[this,6]]),this._idPool=[],this.exited=!1;let n=4096;const s=h=>{const e=n,t=d.encode(h+"\\0");return new Uint8Array(this.mem.buffer,n,t.length).set(t),n+=t.length,n%8!==0&&(n+=8-n%8),e},i=this.argv.length,c=[];this.argv.forEach(h=>{c.push(s(h))}),c.push(0);const f=Object.keys(this.env).sort();f.forEach(h=>{c.push(s(`${h}=${this.env[h]}`))}),c.push(0);const u=n;c.forEach(h=>{this.mem.setUint32(n,h,!0),this.mem.setUint32(n+4,0,!0),n+=8}),this._inst.exports.run(i,u),this.exited&&this._resolveExitPromise(),await this._exitPromise}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(r){const n=this;return function(){const s={id:r,this:this,args:arguments};return n._pendingEvent=s,n._resume(),s.result}}},global.require&&global.require.main===module&&global.process&&global.process.versions&&!global.process.versions.electron){process.argv.length<3&&(console.error("usage: go_js_wasm_exec [wasm binary] [arguments]"),process.exit(1));const r=new Go;r.argv=process.argv.slice(2),r.env=Object.assign({TMPDIR:require("os").tmpdir()},process.env),r.exit=process.exit,WebAssembly.instantiate(fs.readFileSync(process.argv[2]),r.importObject).then(n=>(process.on("exit",s=>{s===0&&!r.exited&&(r._pendingEvent={id:0},r._resume())}),r.run(n.instance))).catch(n=>{console.error(n),process.exit(1)})}})();\nonmessage=({data:c})=>{let y=new TextDecoder,s=global.fs,a="";s.writeSync=(e,t)=>{if(e===1)self.postMessage(t);else if(e===2){a+=y.decode(t);let n=a.split(`\n`);n.length>1&&console.log(n.slice(0,-1).join(`\n`)),a=n[n.length-1]}else throw new Error("Bad write");return t.length};let l=[],i,r=0;onmessage=({data:e})=>{e.length>0&&(l.push(e),i&&i())},s.read=(e,t,n,d,u,m)=>{if(e!==0||n!==0||d!==t.length||u!==null)throw new Error("Bad read");if(l.length===0){i=()=>s.read(e,t,n,d,u,m);return}let g=l[0],h=Math.max(0,Math.min(d,g.length-r));t.set(g.subarray(r,r+h),n),r+=h,r===g.length&&(l.shift(),r=0),m(null,h)};let o=new global.Go;o.argv=["","--service=0.8.27"],WebAssembly.instantiate(c,o.importObject).then(({instance:e})=>o.run(e))};}',i;if(r){let v=new Blob([l],{type:"application/javascript"});i=new Worker(URL.createObjectURL(v))}else{let v=new Function("postMessage",l+"var onmessage; return m => onmessage(m)"),$=v(S=>i.onmessage({data:S}));i={onmessage:null,postMessage:S=>$({data:S}),terminate(){}}}i.postMessage(p),i.onmessage=({data:v})=>f(v);let{readFromStdout:f,afterClose:c,service:h}=ye({writeToStdin(v){i.postMessage(v)},isSync:!1,isBrowser:!0});return{build:v=>new Promise(($,S)=>h.buildOrServe("build",null,v,!1,(k,D)=>k?S(k):$(D))),transform:(v,$)=>(v+="",new Promise((S,k)=>h.transform("transform",v,$||{},!1,{readFile(D,P){P(new Error("Internal error"),null)},writeFile(D,P){P(null)}},(D,P)=>D?k(D):S(P)))),serve(){throw new Error('The "serve" API only works in node')},buildSync(){throw new Error('The "buildSync" API only works in node')},transformSync(){throw new Error('The "transformSync" API only works in node')},stop(){i.terminate(),c()}}});export{Te as build,De as buildSync,Fe as serve,Pe as startService,Ie as transform,Ue as transformSync,Ae as version};